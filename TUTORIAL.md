# Tutorial: Creating a Multi-Page Application with Needle Engine

This tutorial will guide you through the process of creating a multi-page web application using Needle Engine. In this setup, each "page" or route in your application will load a complete Needle Engine scene. This is suitable for scenarios where you want distinct 3D experiences for different sections of your website.

Needle Engine is flexible and can be integrated with various JavaScript frameworks. However, to keep things focused on the core concepts of multi-page apps with Needle Engine, this tutorial will use **plain HTML and JavaScript**. We'll leverage Vite.js as the build tool, which is the default for new Needle Engine projects created through the Unity or Blender exporters.

## What You'll Learn:

*   How to structure a basic multi-page application.
*   How to embed Needle Engine scenes into separate HTML pages.
*   How to create simple navigation between these pages.
*   Considerations for loading the same or different scenes on various pages.
*   A note on JavaScript frameworks.

Let's get started!

---

## Section 1: Project Setup

Before we dive into creating multiple pages, you'll need a basic Needle Engine project.

**Prerequisites:**

*   You have Needle Engine installed and integrated with Unity or Blender, OR you are comfortable setting up a Vite project and adding the `@needle-tools/engine` package manually.
*   You have at least one `.glb` file (your 3D scene, exported from Unity/Blender or obtained elsewhere) ready to be used. For this tutorial, let's assume you have a file named `scene1.glb` and optionally another one, `scene2.glb`.

**Steps:**

1.  **Create or Open a Needle Engine Project:**
    *   If using Unity or Blender, create a new Needle Engine project or open an existing one. Export your scene(s) to generate the web project. This will typically create a Vite-based project structure for you.
    *   If setting up manually, create a new Vite project (`npm create vite@latest my-needle-app -- --template vanilla`) and install the Needle Engine package (`npm install @needle-tools/engine`). You'll also need to configure it to serve your `.glb` files.

2.  **Locate Your Assets:**
    *   Ensure your `.glb` files (e.g., `scene1.glb`, `scene2.glb`) are placed in a directory that will be served by your web server. In a typical Vite project generated by Needle Engine, this might be the `public/assets/` directory or similar. For this tutorial, we'll assume your assets are accessible at paths like `assets/scene1.glb`.

3.  **Basic Project Structure (Vite Example):**
    Your project directory might look something like this (simplified):

    ```
    my-needle-app/
    ├── public/
    │   └── assets/
    │       └── scene1.glb
    │       └── scene2.glb  (optional)
    ├── src/
    │   └── main.js         (or similar entry point)
    ├── index.html
    ├── package.json
    └── vite.config.js
    ```

    *   `public/`: Static assets that are served as-is.
    *   `src/`: Your JavaScript/TypeScript code.
    *   `index.html`: The default entry point for your web application.

Once your basic project is running and you can view a single Needle Engine scene (e.g., by running `npm run dev` and opening `index.html`), you're ready to create multiple pages.

---

## Section 2: Creating Multiple Pages

To create a multi-page application, you'll simply create multiple HTML files. Each HTML file will represent a different "page" or "route" in your application.

**Steps:**

1.  **Identify Your Main HTML File:**
    Your project already has an `index.html` (or a similarly named default HTML file). This will be one of your pages, often the homepage.

2.  **Create Additional HTML Files:**
    *   In the root of your project (or alongside your `index.html`), create new HTML files for the other pages you need. For example, let's create `page2.html` and `page3.html`.
    *   You can simply copy your existing `index.html` and rename it to get started, then modify its content.

    Your project structure might now look like this:

    ```
    my-needle-app/
    ├── public/
    │   └── assets/
    │       └── scene1.glb
    │       └── scene2.glb
    ├── src/
    │   └── main.js
    ├── index.html      <- Your first page
    ├── page2.html      <- Your second page
    ├── page3.html      <- Your third page
    ├── package.json
    └── vite.config.js
    ```

3.  **Basic HTML Structure for Each Page:**
    Ensure each HTML file has a basic structure. If you copied `index.html`, it should already be fine. If starting from scratch, it would look something like this:

    **`index.html` (example):**
    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Page 1 - My Needle App</title>
        <!-- Link to your main JavaScript file if needed, Vite handles this -->
        <script type="module" src="/src/main.js"></script>
    </head>
    <body>
        <h1>Welcome to Page 1</h1>
        <p>This page will load Scene 1.</p>
        <!-- Needle Engine component will go here -->

        <nav>
            <a href="index.html">Page 1</a> |
            <a href="page2.html">Page 2</a> |
            <a href="page3.html">Page 3</a>
        </nav>
    </body>
    </html>
    ```

    **`page2.html` (example):**
    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Page 2 - My Needle App</title>
        <script type="module" src="/src/main.js"></script>
    </head>
    <body>
        <h1>Welcome to Page 2</h1>
        <p>This page can load Scene 1 again, or Scene 2.</p>
        <!-- Needle Engine component will go here -->

        <nav>
            <a href="index.html">Page 1</a> |
            <a href="page2.html">Page 2</a> |
            <a href="page3.html">Page 3</a>
        </nav>
    </body>
    </html>
    ```
    Modify the titles and any specific content for each page accordingly. We'll add the Needle Engine component in the next section. Note that if your `main.js` is specific to `index.html`'s scene setup, you might need different JS entry points or adapt your `main.js` to handle different pages/scenes. For just loading a `<needle-engine>` tag with a `src`, `main.js` might primarily be for global styles or scripts if any. Many Needle Engine default projects will automatically register the `<needle-engine>` custom element via an import in `main.js`.

With these files in place, you have the basic structure for navigating between different HTML pages. The next step is to embed your Needle Engine scene into each of them.

---

## Section 3: Adding Needle Engine to Each Page

With your HTML pages created, you can now embed a Needle Engine scene into each one. This is done using the `<needle-engine>` custom web component.

**Steps:**

1.  **Ensure Needle Engine is Imported:**
    Typically, in a Vite project set up for Needle Engine (e.g., one exported from Unity/Blender), your main JavaScript file (e.g., `src/main.js` or a similar entry point) will already contain an import statement like:
    ```javascript
    import "@needle-tools/engine"
    ```
    This import registers the `<needle-engine>` custom element, making it available for use in your HTML files. If you set up your project manually, ensure this import is present in a JavaScript file that is loaded on all your pages.

2.  **Add the `<needle-engine>` Component to Each HTML File:**
    In each of your HTML files (`index.html`, `page2.html`, `page3.html`), decide where you want the 3D scene to appear and insert the `<needle-engine>` tag. The crucial part is the `src` attribute, which points to your `.glb` asset.

    **`index.html` (example with Needle Engine):**
    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Page 1 - My Needle App</title>
        <script type="module" src="/src/main.js"></script>
        <style>
            needle-engine {
                width: 80vw;
                height: 60vh;
                margin: auto;
                display: block;
            }
        </style>
    </head>
    <body>
        <h1>Welcome to Page 1</h1>
        <p>This page loads Scene 1.</p>

        <needle-engine src="assets/scene1.glb"></needle-engine>

        <nav>
            <a href="index.html">Page 1</a> |
            <a href="page2.html">Page 2</a> |
            <a href="page3.html">Page 3</a>
        </nav>
    </body>
    </html>
    ```

    **`page2.html` (example with Needle Engine, potentially a different scene):**
    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Page 2 - My Needle App</title>
        <script type="module" src="/src/main.js"></script>
        <style>
            needle-engine {
                width: 80vw;
                height: 60vh;
                margin: auto;
                display: block;
            }
        </style>
    </head>
    <body>
        <h1>Welcome to Page 2</h1>
        <p>This page could load Scene 2, or Scene 1 again.</p>

        <!-- Option 1: Load a different scene -->
        <needle-engine src="assets/scene2.glb"></needle-engine>
        <!-- Option 2: Load the same scene as Page 1 -->
        <!-- <needle-engine src="assets/scene1.glb"></needle-engine> -->

        <nav>
            <a href="index.html">Page 1</a> |
            <a href="page2.html">Page 2</a> |
            <a href="page3.html">Page 3</a>
        </nav>
    </body>
    </html>
    ```

    **`page3.html` (example with Needle Engine):**
    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Page 3 - My Needle App</title>
        <script type="module" src="/src/main.js"></script>
        <style>
            needle-engine {
                width: 80vw;
                height: 60vh;
                margin: auto;
                display: block;
            }
        </style>
    </head>
    <body>
        <h1>Welcome to Page 3</h1>
        <p>This page might also load Scene 1.</p>

        <needle-engine src="assets/scene1.glb"></needle-engine>

        <nav>
            <a href="index.html">Page 1</a> |
            <a href="page2.html">Page 2</a> |
            <a href="page3.html">Page 3</a>
        </nav>
    </body>
    </html>
    ```

    **Key Points:**
    *   **`src` attribute:** Replace `"assets/scene1.glb"` or `"assets/scene2.glb"` with the actual path to your `.glb` files, relative to the `public` directory (or wherever your server serves them from).
    *   **Styling:** Basic CSS is included in the `<style>` tags to give the `<needle-engine>` component some dimensions. Adjust as needed.
    *   **Reusing Scenes:** You can point the `src` attribute of multiple `<needle-engine>` components on different pages to the *same* `.glb` file if you want to reuse the scene. Or, you can use different `.glb` files for different pages.

3.  **Test Your Pages:**
    *   Run your development server (usually `npm run dev` for Vite projects).
    *   Open your browser and navigate to `http://localhost:xxxx/index.html`, then `http://localhost:xxxx/page2.html`, and `http://localhost:xxxx/page3.html` (the port `xxxx` will be specified by Vite, often 3000, 5173, etc.).
    *   You should see the respective Needle Engine scenes loading on each page.

At this point, each HTML file independently loads and displays a Needle Engine scene.

---

## Section 4: Basic Navigation

Navigating between your newly created pages is done using standard HTML hyperlinks (`<a>` tags). In a multi-page application where each page is a separate HTML file, the browser handles the navigation by loading the new HTML file when a link is clicked.

**Steps & Explanation:**

1.  **Add Navigation Links:**
    As shown in the examples in "Section 3", you can add a navigation menu (or individual links) to each of your HTML pages.

    A simple navigation block might look like this, placed consistently across your pages (e.g., in the `<body>` after your main content or in a header/footer):

    ```html
    <nav>
        <a href="index.html">Home (Page 1)</a> |
        <a href="page2.html">Page 2</a> |
        <a href="page3.html">Page 3</a>
    </nav>
    ```

2.  **How it Works:**
    *   When a user clicks on a link (e.g., `<a href="page2.html">Page 2</a>`), the browser requests `page2.html` from the server.
    *   The server sends `page2.html`.
    *   The browser loads `page2.html`. This is a full page load.
    *   The Needle Engine component specified in `page2.html` (e.g., `<needle-engine src="assets/scene2.glb">`) is then initialized, and its scene is loaded.

3.  **Testing Navigation:**
    *   Ensure your development server is running (`npm run dev`).
    *   Open one of your pages (e.g., `index.html`) in the browser.
    *   Click the navigation links to move between `index.html`, `page2.html`, and `page3.html`.
    *   You should observe that each click loads the corresponding HTML page, and the Needle Engine scene on that page loads.

This method is the simplest way to achieve multi-page navigation. For more complex applications, especially those using JavaScript frameworks (like React, Vue, Angular), you would typically use the framework's routing solution (e.g., React Router, Vue Router). However, for plain HTML/JS projects or when each "page" is a distinct experience, direct HTML file linking is perfectly valid.

---

## Section 5: Loading the Same Scene vs. Different Scenes & Component Behavior

In this multi-page setup, it's important to understand how Needle Engine scenes are loaded and what happens to the component itself.

**Loading Different Scenes:**

*   As shown in the examples, you can have `page1.html` load `scene1.glb` and `page2.html` load `scene2.glb`.
*   Each time you navigate to a new HTML page, the browser discards the old page entirely and loads the new one.
*   This means if `page1.html` has `<needle-engine src="assets/scene1.glb">` and `page2.html` has `<needle-engine src="assets/scene2.glb">`, navigating from Page 1 to Page 2 will:
    1.  Unload `index.html` (and `scene1.glb` along with its Needle Engine instance).
    2.  Load `page2.html`.
    3.  The `<needle-engine>` tag in `page2.html` will initialize a **new instance** of the Needle Engine runtime and load `scene2.glb` from scratch.

**Loading the Same Scene on Different Pages:**

*   You might have `page1.html` load `scene1.glb` and `page3.html` also load `scene1.glb`.
    ```html
    <!-- In index.html -->
    <needle-engine src="assets/scene1.glb"></needle-engine>

    <!-- In page3.html -->
    <needle-engine src="assets/scene1.glb"></needle-engine>
    ```
*   Even though it's the same `.glb` file, the behavior is similar to loading different scenes:
    1.  When navigating from Page 1 to Page 3, `index.html` is unloaded.
    2.  `page3.html` is loaded.
    3.  The `<needle-engine>` tag in `page3.html` initializes a **new instance** of the Needle Engine runtime and loads `scene1.glb` again.

**Key Implications:**

*   **Full Scene Reloads:** Every navigation to a new HTML page results in a full reload of the Needle Engine scene specified on that page. There is no persistent state for the 3D scene managed by Needle Engine *between* these HTML pages by default. If you need to maintain state across pages (e.g., player position, selected objects), you would need to implement that separately using web storage (like `localStorage` or `sessionStorage`) or by passing parameters via URLs and then using scripts within your Needle Engine scenes to read and apply that state upon loading.
*   **Needle Engine Component Re-initialization:** The `<needle-engine>` web component itself is re-initialized on each page load. It doesn't carry over from one HTML page to another in this traditional multi-page architecture. The user's request was to load the whole scene for each route/page, and this method achieves that.
*   **Performance:** Loading a 3D scene can take time, depending on its complexity and size. Users will experience this load time on each page transition. This is a trade-off for having distinct, full-scene experiences per page. For applications requiring seamless transitions without reloads, a Single Page Application (SPA) architecture with a JavaScript router that dynamically changes content (and potentially swaps scenes or parts of scenes within a single Needle Engine instance) would be a different approach. However, the issue specifically asked for each route/page to load the whole scene.

**Reusability of the Needle Engine Component:**

*   The `<needle-engine>` **web component definition** (the JavaScript code that defines how `<needle-engine>` works) is loaded once (typically as part of your `main.js` bundle).
*   However, an **instance** of the `<needle-engine>` component is created each time an HTML page containing the tag is loaded.
*   So, while the component's *code* is reused (not re-downloaded if cached), its *state* and the 3D scene it manages are fresh for each HTML page.

This approach directly addresses the requirement that "each route/page should load the whole scene."

---

## Section 6: Which JS Framework to Use?

A common question when building web applications is which JavaScript framework (like Vue, React, Angular, Svelte, etc.) to use.

**Needle Engine's Flexibility:**

As mentioned in the Needle Engine documentation ([https://engine.needle.tools/docs/html.html](https://engine.needle.tools/docs/html.html)):
> "Needle Engine is unoponiated about the choice of framework. Our default template uses the popular vite as bundler. From there, you can add vue, svelte, nuxt, react, react-three-fiber or other frameworks, and we have samples for a lot of them. You can also integrate other bundlers, or use none at all – just plain HTML and Javascript."

**For This Tutorial's Approach (Multiple HTML Files):**

*   **Plain HTML/JS is Sufficient:** For the multi-page architecture described in this tutorial (where each page is a separate HTML file and loads its own scene), you **do not strictly need a JavaScript framework** for routing or page management. Standard HTML links handle navigation, and each page independently initializes its Needle Engine scene.
*   **Simplicity:** This tutorial uses plain HTML and JavaScript (with Vite as a build tool, which is common for Needle Engine projects) to keep the focus on the multi-page concept with Needle Engine itself.

**When to Consider a Framework:**

You might consider using a JavaScript framework if your application requires:

*   **Complex Client-Side Routing (Single Page Applications - SPAs):** If you want smoother transitions between "pages" without full browser reloads, where only parts of the DOM are updated, a framework with a router (like Vue Router, React Router) is essential. This would be a different architectural approach than what's covered here, as it would typically involve a single HTML page and dynamically changing the content, potentially manipulating a single Needle Engine instance to load different scenes or states.
*   **Advanced State Management:** For managing complex application state that needs to be shared across different components or views within a single page.
*   **Component-Based UI:** For building complex user interfaces with reusable UI components.
*   **Large-Scale Applications:** Frameworks often provide structure and conventions that are beneficial for larger projects and teams.

**Recommendation for This Tutorial's Scope:**

*   **Start Simple:** For the goal of having distinct pages each loading a full Needle Engine scene, the plain HTML approach is direct and effective.
*   **Explore Later:** If your needs evolve towards a more SPA-like behavior or require the benefits listed above, you can then explore integrating Needle Engine with your framework of choice. Needle Engine's web component nature (`<needle-engine>`) makes it generally easy to incorporate into components of various frameworks.

The choice of a JS framework depends heavily on the specific requirements and complexity of your overall application, not just the 3D scene rendering part.

---

## Conclusion

You've now learned the fundamentals of creating a multi-page application with Needle Engine, where each HTML page loads its own 3D scene. This approach is straightforward for projects that benefit from distinct, full-scene experiences for different sections or routes.

**Key Takeaways:**

*   Multi-page apps with Needle Engine can be built using standard HTML files for each page.
*   The `<needle-engine src="path/to/your.glb">` web component is used on each page to embed your 3D scenes.
*   Navigation is handled by simple HTML hyperlinks (`<a>` tags).
*   Each page navigation results in a full load of the new HTML page and re-initialization of the Needle Engine scene specified on that page.
*   Needle Engine is flexible and can be used with plain HTML/JS (as in this tutorial) or integrated into various JavaScript frameworks if more advanced SPA features are needed.

**Further Exploration:**

*   Experiment with loading different `.glb` assets on different pages.
*   Explore styling the `<needle-engine>` component and its container further.
*   If you need to pass data between scenes (e.g., user choices, scores), investigate using `localStorage`, `sessionStorage`, or URL parameters, and then use custom scripts within your Needle Engine scenes to act on this data.
*   For more advanced interactions or SPA-like behavior, consult the official Needle Engine documentation for guidance on using it with frameworks like Vue, React, or Svelte.

We hope this tutorial helps you structure your multi-page Needle Engine projects effectively! For more detailed information on Needle Engine features and capabilities, always refer to the [official Needle Engine Documentation](https://engine.needle.tools/docs).
